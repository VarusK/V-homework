# 我的科普博客——区块链
### **Posted on 2018.10.10**
### *本文只针对小白进行简单的科普，不涉及较多专业性知识。*

>得益于比特币的火爆，作为其底层技术，区块链逐渐成为了当前的大热点，被认为是自互联网发明以来最具颠覆性的技术创新。那么就让我们一起来看看这个区块链是什么吧。

## 一、 什么是区块链？

官方解释是“区块链是去中心化、点对点交易、有共识机制的分布式数据库”。  

区块链起源于中本聪的比特币，本质上是一个分布式、去中心化的数据库。它依靠密码学和数学的分布式算法，在无法建立信任关系的互联网上，无需第三方中心的介入就可以使参与者达成共识，以极低的成本解决了信任与价值的可靠传递难题。
![](https://cdn.8btc.com/wp-content/uploads/2018/03/201803060149058189.png)
我们可以用记账的比喻来描述区块链技术，区块链技术相当于一种全民参与记账的方式。所有参与者的账本都是完全一样的，且独立保存在自己手中（电脑里），每个人都有平等的权利参与记账。

账本上的每一页纸就是一个“区块”，用来记录交易数据。然后每页纸上都会标注上一页的页码和本页页码，通过页码指示，可以将每一页按顺序连结成为一条“链”，从而形成区块链。
![](https://cdn.8btc.com/wp-content/uploads/2018/03/201803060149091953.png)

区块链是在符合现实社会法律法规前提下，可治理的，依赖于密码学算法和博弈经济性设计，基于共识算法，对发生在主体间的价值创造，价值转移，价值交换，以及涉及到各个价值主体由机器驱动的业务流程，在多个对等的主体间形成的共识，从而达到共享业务状态，共享价值状态，即共享账本，以达到加速社会资源配置和价值流通，最终提高生产力的目的。

区块链的本质是共识，在互不信任的主体间的共识就形成了公认的价值。区块链的目标是解放和提高整个社会的生产力，手段是将生产关系虚拟化，运用IoT和价值锚定技术将现实世界和虚拟世界无缝连接起来，虚拟化的业务合约可以由机器自动化驱动现实和虚拟社会的资源配置，价值生产和流通，结合大数据智能分析优化虚拟的生产关系，现实和虚拟的法律法规和治理机制为虚拟的区块链社会的稳定发展提供保障。

**哎，我也知道你看不懂咱们举个栗子：**   
小伙带着女朋友回家过年，跟女朋友见了自己的父母亲戚朋友，把认识的都带着看了个遍，随后女朋友为了感谢他们见证与小伙的爱情，就拿出从家乡带了不同的土特产发给他们，大家也认为很正常的接受了礼物，不同的土特产大家还能跟不同的人交换着吃，大家合影拍照发朋友圈并打印出来保存留作纪念。小伙后来跟女朋友分手了，又找了个新女朋友带回家，他跟现女友说“你是我的初恋”，他如果想让现女友完全不知道前女友的事，小伙就要阻止全部知道前女友的人说出以前那件事，这几乎是不可能的。现在从区块链的角度解释下：见过的每个人都是一个“节点”，他们见证爱情这件事的经过是挖矿的过程，前女友发放的“土特产”是矿工奖励（如比特币），小伙带前女友见了所有认识的人而不是一个人或少数人就是“去中心化”，大家接受礼物认为很正常是共同默认的“共识机制”，大家把土特产交换是“点对点交易”，亲朋好友见过的每个人都保留一份前女友有价值的历史记录-----合影及朋友圈就是“分布式数据库”，小伙后来带着新女友回家，他不想让现女友知道有前女友的事就是“篡改区块链信息”，小伙无法隐瞒是因为“全网51%攻击成功很难实现”。

## 二、 区块如何产生？

大概每隔10分钟，就会有一个新的页产生，所有的参与者都可以在这页上记账，谁先最快记完账，就可以把这页添加到账本里，并得到一笔奖励（比如比特币）。而其他没完成的参与者手里的页就会作废，只能继续等待另一个新页产生，然后重新开始记账。
![](https://cdn.8btc.com/wp-content/uploads/2018/03/201803060149127330.png)
所以，区块链的逻辑很简单，就是比谁更快。

那么，新的问题来了，记账过程中要是有人做假账怎么办？要知道，现实生活中假账也是不容易解决的难题，在彼此都没有信任基础的互联网上，人们又怎么能相信这个虚拟账本呢？

在无人管理的状态下，比特币从2009年开始已经运行到第9个年头了，迄今为止没有出现大的问题，反而社区越来越庞大，让人不得不惊讶。

而这一切都依赖于区块链复杂的技术逻辑了。

## 三、 区块链的适用场景？

区块链最大的意义在于它可以把很多高人力成本的信任问题，转化为机器的共识来解决。但是，为了保证数据的可靠性，区块链也有自己的代价。一是效率，数据写入区块链，最少要等待十分钟，所有节点都同步数据，则需要更多的时间；二是能耗，区块的生成需要矿工进行无数无意义的计算，这是非常耗费能源的。

因此，区块链的适用场景目前来讲还是很有限的，它需要满足以下几种情形：

- 不存在所有成员都信任的管理当局
- 写入的数据不要求实时使用
- 挖矿的收益能够弥补本身的成本  

如果无法满足上述的条件，那么传统的数据库是更好的解决方案。
![](https://cdn.8btc.com/wp-content/uploads/2018/03/201803060149151223.png)


## 四、补充知识
### 业务合约和账本
在现实世界，我们每个人都处在各种关系契约中，所有人在契约的约定下参与整个社会的生产和生活。区块链技术最终要能促进生产关系虚拟化，推动生产力的发展，整个区块链生态系统的核心就是要能支持各种契约，即业务合约，并在相关参与者间共享交易账本。

业务合约大到非常复杂的业务合约流程，这要高于企业各自的流程，是各个企业、组织或个人作为流程主体共同参与制定共同认可的生产关系流程契约。比业务合约流程粒度小的业务合约称为合约服务，合约服务是在语义层面对业务行为进行抽象的最小契约，合约服务由一组合约动作（action）构成。作为抽象的合约服务的具体实现，合约代码可以由不同合约语言编写，合约代码中引用的业务条款和法律条款也都可以有具体的不同实现语言。

### 合约流程

合约流程实现了基于合约服务的一系列固定的，按照既定业务规则和法律条款串联或并联起来的合约动作，通过各个合约动作的完成，实现业务在各个流程参与方的执行，实现由机器流程引擎驱动的价值高速自动创造，自动流转，自动交换。合约流程一旦运行起来就是一个状态机，合约流程在参与方间共享流程状态，也就是共享一致的状态机的状态。

业务参与各方在阅读具体的业务合约流程业务规则，法律条款后，签定合约流程契约，合约流程生效，流程可以通过时间触发，也可以是链上的事件触发，也可以Oracle事件触发，也可以人工触发。初始化后的流程实例按照后续节点的类型，人工节点或是计算节点，实现通过UI界面或API的外部输入确认的人工执行驱动，或调用合约服务的具体action实现代码的机器计算驱动，形成业务价值交易，流程引擎调用业务条款检查服务和法律条款检查服务，获得业务节点的业务规则状态和法律条款满足状态，按照既定的流程规则，引擎驱动流程判断流向下一（多）个节点。

业务流程在各个节点流转时，由流程引擎驱动形成一个个的流程流转交易，业务流程合约参与方通过共享流程流转交易实现流程状态共享的目的。流程验证者在本地的沙盒中执行对流程流转交易的验证，实现流程状态机一致的状态流转。

### 合约服务

作为业务合约的主体，定义了业务合约最基本的服务内容，每一个合约服务就是一种最小的完整的概念层面的业务语义定义。合约服务定义了完成业务所需的一个或多个合约动作（action），每个合约动作定义了输入状态和输出状态和要执行的业务逻辑命令。

合约服务本身和每一个合约动作，以及其中用到的任何合约条款法律条款都需要用人类语言进行清晰明确的描述，必要时提供形式化语义描述以免出现语言理解偏差。每一个合约动作的执行形成一个明确的合约价值交易。合约流程引擎在执行流程节点流转时，按照流程定义的对合约服务动作的调用，自动进行服务动作的执行，从而产生业务价值交易，这是一种内在的合约服务调用。合约服务的调用也可以是外在的，由用户通过UI界面基于外部API接口实现调用。

合约服务可以是一种组合服务，对现有的合约服务动作进行组合，形成新的服务动作业务语义。合约服务的可组合化有利于基于已有的业务合约定义，通过快速构建新型的业务合约进行生产关系创新，实现不同产业价值服务的零距离整合。为了实现合约服务的自包含化，并支持服务流程的编排，以及服务计算容器化、分布式、可扩展的架构部署要求，合约服务需要定义成无状态的。当签约用户或流程调用合约服务时，合约服务会进行服务路由，基于链服务管理的路由规则，选择特定的合约代码实现来具体验证执行业务价值交易。

### 合约代码

合约服务的每一个合约动作都会产生业务价值交易，业务价值交易会在合约代码实现上进行执行和验证。作为交易验证者，合约服务可以有多种实现，如不同合约语言的实现，不同合约提供商的版本实现，不同利益相关方的合约代码实现，这有利于所有的合约服务参与者去中心化，并在抽象的业务层面就达成共识。

合约代码实现了合约动作定义的输入状态和输出状态和要执行的一组业务逻辑命令计算，命令是最小的执行单元，可以是调用一个技术服务，如生成zkSNARK证明，也可以是输入和输出状态检查、逻辑计算、法律条款服务检查等。

经过所有的命令执行，如果输入状态可以确定性地得到输出状态，对于合约服务的发起者就可以形成一个业务价值交易建议，而其他参与者可以对这个业务价值交易建议进行验证。对于合约流程产生的流程流转交易，由流程执行建议者计算出状态迁移交易建议，由流程执行验证者进行本地流程流转验证。

### 价值共享账本

合约流程的流转会产生流程流转交易，合约服务的执行会形成业务价值交易，所有的这些交易日志，被分类按应用按联盟团体组织成区块链或者交易链，形成不可更改和抵赖的数据结构，在各个参与方之间形成一个统一的状态账本。价值共享账本需要以高效、规范的方式进行数据组织，包括交易日志和账本状态，以便于流程状态（状态机）和资产状态数据库的快速更新，也便于对历史交易进行快速查找和回溯。另外，价值共享账本底层还需要有共享的通信机制，如使用各种P2P算法，便于相关方进行基于权限的相关交易数据的快速同步。

### 区块链平台服务  

区块链平台服务提供所有区块链平台层面的公共服务，平台服务同具体的业务无关，是可以为所有业务合约所共享的服务。各种平台服务可以是链上的，也可以是链外的，一同构成一个区块链平台不可或缺的能力。主要包括合约合规，安全控制，链上共识，链服务管理，治理（链上、链外），开发运维。

### 合约合规

合约合规服务将那些公共的合规性要求抽取出来，形成各个业务都通用的规则条款检查服务，合约条款验证服务，法律条款验证服务，Oracle服务约定，合约宪法条款约定。

合约宪法指明了合约纠纷适用的法律，争议解决办法，以及人类可读的合约意图等。一个实际的区块链平台能够同现实社会经济并行运行的一个前提条件就是同现实社会一致的合法合规性。不论是把现实世界中心化的合约去中心化建模成虚拟世界的业务合约，还是基于区块链新型的生产关系新创造的业务合约，合法合规依然是根本。

法律和规则都可以以最低粒度的条款内容存在，为了支持业务合约的快速搭建和创新，将通用的合约条款，规则条款，法律条款实现为一种服务，基于对条款服务的引用和基于条款服务的组合，可以实现更高粒度的合规合法性验证要求。业务合约可以基于这些合约规则，合约条款，法律条款和组合的合规合法性验证要求自动进行交易的合规性验证。

对于那些无法由代码实现的验证内容和合约意图，可以通过人类可以理解的方式通过合约宪法指定合约运行所依赖的现实世界法律，指定出现无法在链上解决的争议，在现实世界的解决办法。合约流程和合约服务如果使用现实世界数据输入的，为了达到确定性运行，所有验证人的验证执行都必须依赖相同的Oracle服务或者交易各方都认可的Oracle服务。

### 安全控制

区块链在平台安全层面需要设计隐私模型，权限模型。

同现实世界人们需要一定的隐私性和匿名性一样，区块链虚拟世界也需要提供相应的隐私保护给用户。对于公有链，出于网络的安全考虑，往往需要交易无关方对交易内容执行验证，必须让用户身份信息同用户的交易信息隔离，使用户身份得到保护，甚至采用零知识证明zkSNARK算法仅向验证者提供一个无需暴露交易内容的证明，验证者就可完成验证，做到绝对的交易身份隐匿。

许可链由于网络的参与方都是受控的，所以防范网络攻击的安全需求没有公有链那么高，共识机制只需确保技术层面的一致和完备，交易业务层面的验证可以只在交易相关方进行验证，这样可以保证交易无关方看不到任何交易内容，即使是加密的交易内容也看不到。

公有链是一种开放权限的设计思路，不会显式的设定不同参与人的操作权限，只会采用黑名单机制。而许可链是一种白名单机制，有非常严格的准入机制，只有允许的参与方才可以参与被允许的业务合约。许可链通常采用PKI基础设施通过自身的CA机构，同企业现有的权限管理系统进行集成，如LDAP、AD服务器，进而控制不同的人具有不同的合约操作权限。

区块链由于采用公私钥机制进行交易，不论采用哪种数据模型，都存在最小粒度的基于私钥的账户概念。区块链存在两种类型的合约账户：合约流程账户（Contract Process Account， CPA）和合约服务账户（Contract Service Account， CSA）。外部用户也会有自己的私钥账户（User Account， UA），外部用户账户会参与到合约流程账户和合约服务账户相关的活动中，而合约流程账户会依赖合约服务账户执行相关的合约动作调用。

不同的合约流程和合约服务实例化后的相互关系会非常复杂，我们可以把这三种账户按照使用关系和依赖关系组织成树状结构，采用merkle证明的方式进行权限证明验证。

### 链上共识

共识机制是区块链建立信任的基石。不同类型的区块链出于不同的考虑会选择不同的共识算法或者采用共识算法的组合。共识的内容包括账本的规范化（如何组织区块，组织交易链），交易的确定性执行结果，交易的非双花唯一性，交易的顺序完备性，以及其他保证网络安全稳定运行的其他信息（如数据可用性）。

另一方面，共识机制的运行又不应同账本的规范化和交易的验证紧密绑定在一起，这也遵从关注点分离的架构原则，有利于区块链平台整体的模块化，插件化，容器化，有利于平台的横向扩展性。


## 五、 结语

眼下区块链大热，不是热在拿技术解决现实问题，而是热在集资圈钱、炒作估值，跟技术创新无关。因而监管层采取了取缔ICO、关闭数字货币交易所等一系列行动，不过，一刀切式地打击并不能根本解决问题。逆水行舟不进则退，既然时代选择了区块链，如果中国的区块链技术继续停滞不前，可能离被行业整出局就不远了。

对于目前的区块链热，监管部门应主动地介入，区分是技术创新还是集资炒作，全面遏制区块链名义下的集资炒作，同时也要结合我国区块链技术和应用发展情况，及时出台区块链技术和产业发展扶持政策，重点支持关键技术攻关、重大示范工程、“双创”平台建设、系统解决方案研发和公共服务平台建设等。同时，国内重点企业、科研、高校和用户单位建议加强联合，加快共识机制、可编程合约、分布式存储、数字签名等核心关键技术攻关。

例如，今年2月4日杭州“两会”上，杭州第一个将“区块链”写入了政府工作报告，欲加快培育区块链等未来产业。杭州在区块链方面已走在全国前面。正如澎湃评论所言“只有拥抱区块链，才能真正管理市场”，主动拥抱区块链技术，理性客观面对，给出相对宽松的发展空间或许是目前最好的政策途径。从最近的舆论风向来看，我想距离真正的政策下来已经不远了。